\begin{tikzpicture}
\begin{groupplot}[group style={group size={2 by 2}, horizontal sep={0.1\linewidth}, vertical sep={0.15\linewidth}}, grid={major}, width={0.45\linewidth}, height={0.3\linewidth}, legend style={legend columns={-1}, font={\small}}]
    \nextgroupplot[xmode=log,ymode=log, title={$m = 2$}, legend to name={timings_legend}]
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  8.105e-6  \\
            17.0  5.101e-6  \\
            28.0  5.456e-6  \\
            46.0  6.68e-6  \\
            77.0  8.582e-6  \\
            129.0  1.2516e-5  \\
            215.0  1.7881e-5  \\
            359.0  2.9152e-5  \\
            599.0  4.4903e-5  \\
            1000.0  7.1365e-5  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  3.558e-6  \\
            17.0  2.732e-6  \\
            28.0  7.467e-6  \\
            46.0  1.8718e-5  \\
            77.0  3.7052e-5  \\
            129.0  6.513e-5  \\
            215.0  0.000184449  \\
            359.0  0.000302819  \\
            599.0  0.000531694  \\
            1000.0  0.00098722  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  1.716e-6  \\
            17.0  5.087e-6  \\
            28.0  1.3638e-5  \\
            46.0  3.7305e-5  \\
            77.0  0.000107208  \\
            129.0  0.000302074  \\
            215.0  0.000841803  \\
            359.0  0.002361479  \\
            599.0  0.006582331  \\
            1000.0  0.018678573  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  1.496e-6  \\
            17.0  4.547e-6  \\
            28.0  1.2796e-5  \\
            46.0  3.5941e-5  \\
            77.0  0.000102888  \\
            129.0  0.000289543  \\
            215.0  0.000809039  \\
            359.0  0.002265557  \\
            599.0  0.006333679  \\
            1000.0  0.017924228  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  1.97e-7  \\
            17.0  2.95e-7  \\
            28.0  5.02e-7  \\
            46.0  7.96e-7  \\
            77.0  1.292e-6  \\
            129.0  2.159e-6  \\
            215.0  3.628e-6  \\
            359.0  6.083e-6  \\
            599.0  1.7636e-5  \\
            1000.0  1.7269e-5  \\
        }
        ;
    \legend{{$\widehat{\ECE}$ (uniform)},{$\widehat{\ECE}$ (data-dependent)},{$\biasedestimator$},{$\unbiasedestimator$},{$\linearestimator$}}
    \nextgroupplot[xmode=log,ymode=log, title={$m = 10$}]
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  5.829e-6  \\
            17.0  8.582e-6  \\
            28.0  1.1468e-5  \\
            46.0  1.7465e-5  \\
            77.0  2.7378e-5  \\
            129.0  4.5206e-5  \\
            215.0  7.0561e-5  \\
            359.0  0.000120751  \\
            599.0  0.000368665  \\
            1000.0  0.000454025  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  2.024e-6  \\
            17.0  3.162e-6  \\
            28.0  9.036e-6  \\
            46.0  2.2982e-5  \\
            77.0  4.6696e-5  \\
            129.0  8.3165e-5  \\
            215.0  0.000212948  \\
            359.0  0.000490558  \\
            599.0  0.001196755  \\
            1000.0  0.001644882  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  2.332e-6  \\
            17.0  6.923e-6  \\
            28.0  1.8831e-5  \\
            46.0  5.0292e-5  \\
            77.0  0.000140865  \\
            129.0  0.000394514  \\
            215.0  0.001095198  \\
            359.0  0.003049525  \\
            599.0  0.008498855  \\
            1000.0  0.023993277  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  2.028e-6  \\
            17.0  6.242e-6  \\
            28.0  1.7557e-5  \\
            46.0  4.8223e-5  \\
            77.0  0.000135778  \\
            129.0  0.000382046  \\
            215.0  0.001063188  \\
            359.0  0.002972936  \\
            599.0  0.008272196  \\
            1000.0  0.023498167  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  2.43e-7  \\
            17.0  3.9e-7  \\
            28.0  6.56e-7  \\
            46.0  1.072e-6  \\
            77.0  1.772e-6  \\
            129.0  2.999e-6  \\
            215.0  5.03e-6  \\
            359.0  8.382e-6  \\
            599.0  1.4036e-5  \\
            1000.0  2.3583e-5  \\
        }
        ;
    \nextgroupplot[xmode=log,ymode=log, title={$m = 100$}]
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  3.6552e-5  \\
            17.0  6.1622e-5  \\
            28.0  0.00010941  \\
            46.0  0.000149642  \\
            77.0  0.000243986  \\
            129.0  0.000405278  \\
            215.0  0.000674296  \\
            359.0  0.001110573  \\
            599.0  0.001848908  \\
            1000.0  0.003138658  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  9.358e-6  \\
            17.0  1.4007e-5  \\
            28.0  3.8381e-5  \\
            46.0  7.6134e-5  \\
            77.0  0.000157715  \\
            129.0  0.000310326  \\
            215.0  0.000654385  \\
            359.0  0.00152402  \\
            599.0  0.002620417  \\
            1000.0  0.00512852  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  3.783e-6  \\
            17.0  1.1294e-5  \\
            28.0  3.055e-5  \\
            46.0  8.2009e-5  \\
            77.0  0.000226478  \\
            129.0  0.000635668  \\
            215.0  0.001775478  \\
            359.0  0.004934371  \\
            599.0  0.013771252  \\
            1000.0  0.038987181  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  3.474e-6  \\
            17.0  1.0248e-5  \\
            28.0  2.8157e-5  \\
            46.0  7.8026e-5  \\
            77.0  0.000219937  \\
            129.0  0.000619168  \\
            215.0  0.001754994  \\
            359.0  0.004822927  \\
            599.0  0.013500926  \\
            1000.0  0.038099229  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  4.91e-7  \\
            17.0  6.05e-7  \\
            28.0  1.078e-6  \\
            46.0  2.499e-6  \\
            77.0  2.921e-6  \\
            129.0  6.79e-6  \\
            215.0  8.268e-6  \\
            359.0  1.4918e-5  \\
            599.0  2.5619e-5  \\
            1000.0  4.276e-5  \\
        }
        ;
    \nextgroupplot[xmode=log,ymode=log, title={$m = 1000$}]
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  0.000310552  \\
            17.0  0.000680865  \\
            28.0  0.000854977  \\
            46.0  0.001409167  \\
            77.0  0.002314362  \\
            129.0  0.003930397  \\
            215.0  0.006546884  \\
            359.0  0.010971368  \\
            599.0  0.018269687  \\
            1000.0  0.032236778  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  7.4616e-5  \\
            17.0  0.00012395  \\
            28.0  0.000267183  \\
            46.0  0.000663684  \\
            77.0  0.001403748  \\
            129.0  0.002666566  \\
            215.0  0.005604363  \\
            359.0  0.011450187  \\
            599.0  0.02103853  \\
            1000.0  0.040609816  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  1.5007e-5  \\
            17.0  4.2523e-5  \\
            28.0  0.000120485  \\
            46.0  0.000334297  \\
            77.0  0.000987929  \\
            129.0  0.00283015  \\
            215.0  0.007650551  \\
            359.0  0.021663485  \\
            599.0  0.063236937  \\
            1000.0  0.178661653  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  1.2623e-5  \\
            17.0  3.9095e-5  \\
            28.0  0.00010753  \\
            46.0  0.00031409  \\
            77.0  0.000958773  \\
            129.0  0.002724594  \\
            215.0  0.007648026  \\
            359.0  0.021273919  \\
            599.0  0.059805717  \\
            1000.0  0.176433638  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            10.0  1.655e-6  \\
            17.0  2.659e-6  \\
            28.0  5.706e-6  \\
            46.0  1.042e-5  \\
            77.0  1.8799e-5  \\
            129.0  3.1032e-5  \\
            215.0  5.1295e-5  \\
            359.0  8.6107e-5  \\
            599.0  0.000142736  \\
            1000.0  0.00025236  \\
        }
        ;
\end{groupplot}
\node[anchor=north, align=center] at ($(group c1r2.west |- group c1r2.outer south)!0.5!(group c2r2.east |- group c2r2.outer south)$){number of samples \\[0.05\linewidth] \pgfplotslegendfromname{timings_legend}};
\node[anchor=south, rotate=90] at ($(group c1r1.north -| group c1r1.outer west)!0.5!(group c1r2.south -| group c1r2.outer west)$){time [sec]};
\end{tikzpicture}

\begin{tikzpicture}
\begin{groupplot}[group style={group size={2 by 2}, horizontal sep={0.1\linewidth}, vertical sep={0.15\linewidth}}, grid={major}, width={0.45\linewidth}, height={0.3\linewidth}, legend style={legend columns={-1}, font={\small}}]
    \nextgroupplot[xmode=log,ymode=log, title={$m = 2$}, legend to name={timings_legend}]
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  3.6e-7  \\
            2.0  4.76e-7  \\
            5.0  1.017e-6  \\
            10.0  1.676e-6  \\
            22.0  6.942e-6  \\
            46.0  1.4612e-5  \\
            100.0  1.7527e-5  \\
            215.0  5.1846e-5  \\
            464.0  7.2286e-5  \\
            1000.0  0.000144164  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.606e-6  \\
            2.0  1.399e-6  \\
            5.0  1.507e-6  \\
            10.0  3.489e-5  \\
            22.0  8.0447e-5  \\
            46.0  0.000127737  \\
            100.0  0.000299692  \\
            215.0  0.000733089  \\
            464.0  0.001830431  \\
            1000.0  0.004612335  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  6.6e-8  \\
            2.0  1.11e-7  \\
            5.0  5.2e-7  \\
            10.0  2.951e-6  \\
            22.0  1.3069e-5  \\
            46.0  4.2969e-5  \\
            100.0  0.000206072  \\
            215.0  0.000960627  \\
            464.0  0.00453711  \\
            1000.0  0.022921703  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.5e-8  \\
            2.0  7.2e-8  \\
            5.0  4.3e-7  \\
            10.0  2.428e-6  \\
            22.0  8.976e-6  \\
            46.0  4.1745e-5  \\
            100.0  0.00025705  \\
            215.0  0.000945088  \\
            464.0  0.004473628  \\
            1000.0  0.023176209  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.6e-8  \\
            2.0  7.1e-8  \\
            5.0  1.2e-7  \\
            10.0  3.21e-7  \\
            22.0  5.24e-7  \\
            46.0  1.055e-6  \\
            100.0  3.097e-6  \\
            215.0  4.905e-6  \\
            464.0  1.1e-5  \\
            1000.0  2.349e-5  \\
        }
        ;
    \legend{{$\widehat{\ECE}$ (uniform)},{$\widehat{\ECE}$ (data-dependent)},{$\biasedestimator$},{$\unbiasedestimator$},{$\linearestimator$}}
    \nextgroupplot[xmode=log,ymode=log, title={$m = 10$}]
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  4.12e-7  \\
            2.0  5.0e-7  \\
            5.0  1.044e-6  \\
            10.0  3.203e-6  \\
            22.0  4.079e-6  \\
            46.0  8.789e-6  \\
            100.0  1.9023e-5  \\
            215.0  3.7795e-5  \\
            464.0  8.3858e-5  \\
            1000.0  0.000264123  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  1.592e-6  \\
            2.0  1.419e-6  \\
            5.0  1.447e-6  \\
            10.0  4.401e-5  \\
            22.0  8.0974e-5  \\
            46.0  0.000225312  \\
            100.0  0.000678495  \\
            215.0  0.002081999  \\
            464.0  0.005681879  \\
            1000.0  0.018203101  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  5.5e-8  \\
            2.0  1.35e-7  \\
            5.0  6.67e-7  \\
            10.0  3.633e-6  \\
            22.0  1.9654e-5  \\
            46.0  6.4648e-5  \\
            100.0  0.000250108  \\
            215.0  0.00115211  \\
            464.0  0.005393975  \\
            1000.0  0.027440645  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.5e-8  \\
            2.0  8.5e-8  \\
            5.0  5.18e-7  \\
            10.0  2.891e-6  \\
            22.0  1.832e-5  \\
            46.0  6.3034e-5  \\
            100.0  0.000244544  \\
            215.0  0.001133926  \\
            464.0  0.005304188  \\
            1000.0  0.027260501  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.7e-8  \\
            2.0  8.1e-8  \\
            5.0  1.36e-7  \\
            10.0  3.66e-7  \\
            22.0  9.77e-7  \\
            46.0  1.98e-6  \\
            100.0  2.865e-6  \\
            215.0  6.116e-6  \\
            464.0  1.3486e-5  \\
            1000.0  3.9417e-5  \\
        }
        ;
    \nextgroupplot[xmode=log,ymode=log, title={$m = 100$}]
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  6.16e-7  \\
            2.0  1.063e-6  \\
            5.0  3.817e-6  \\
            10.0  5.998e-6  \\
            22.0  2.5986e-5  \\
            46.0  3.2667e-5  \\
            100.0  4.1166e-5  \\
            215.0  8.9101e-5  \\
            464.0  0.00019195  \\
            1000.0  0.000431338  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  1.596e-6  \\
            2.0  1.649e-6  \\
            5.0  1.775e-6  \\
            10.0  0.000134801  \\
            22.0  0.000404969  \\
            46.0  0.001374154  \\
            100.0  0.004336751  \\
            215.0  0.013655125  \\
            464.0  0.038686707  \\
            1000.0  0.1046646  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  1.14e-7  \\
            2.0  2.02e-7  \\
            5.0  9.58e-7  \\
            10.0  4.785e-6  \\
            22.0  2.3069e-5  \\
            46.0  7.4892e-5  \\
            100.0  0.00035296  \\
            215.0  0.001634369  \\
            464.0  0.007908574  \\
            1000.0  0.038673118  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.5e-8  \\
            2.0  1.02e-7  \\
            5.0  7.34e-7  \\
            10.0  4.14e-6  \\
            22.0  2.1677e-5  \\
            46.0  7.2115e-5  \\
            100.0  0.000347592  \\
            215.0  0.001628341  \\
            464.0  0.007808053  \\
            1000.0  0.038680057  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.6e-8  \\
            2.0  1.03e-7  \\
            5.0  1.78e-7  \\
            10.0  4.86e-7  \\
            22.0  1.05e-6  \\
            46.0  2.67e-6  \\
            100.0  4.174e-6  \\
            215.0  1.2628e-5  \\
            464.0  2.1798e-5  \\
            1000.0  4.7462e-5  \\
        }
        ;
    \nextgroupplot[xmode=log,ymode=log, title={$m = 1000$}]
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  3.542e-6  \\
            2.0  7.689e-6  \\
            5.0  1.82e-5  \\
            10.0  4.4353e-5  \\
            22.0  0.000144788  \\
            46.0  0.000165386  \\
            100.0  0.000294268  \\
            215.0  0.000770076  \\
            464.0  0.001703  \\
            1000.0  0.003659697  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  3.479e-6  \\
            2.0  4.384e-6  \\
            5.0  7.766e-6  \\
            10.0  0.000546038  \\
            22.0  0.002282362  \\
            46.0  0.007338685  \\
            100.0  0.02156891  \\
            215.0  0.053593097  \\
            464.0  0.13823644  \\
            1000.0  0.350213895  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.62e-7  \\
            2.0  7.74e-7  \\
            5.0  4.038e-6  \\
            10.0  1.8482e-5  \\
            22.0  7.2269e-5  \\
            46.0  0.000335239  \\
            100.0  0.001691482  \\
            215.0  0.008024919  \\
            464.0  0.037964614  \\
            1000.0  0.182560576  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.6e-8  \\
            2.0  2.94e-7  \\
            5.0  2.804e-6  \\
            10.0  1.5167e-5  \\
            22.0  6.6761e-5  \\
            46.0  0.000331699  \\
            100.0  0.001660626  \\
            215.0  0.008001985  \\
            464.0  0.036981963  \\
            1000.0  0.183027686  \\
        }
        ;
    \addplot+[x={nsamples}, y={time}]
        table[row sep={\\}]
        {
            nsamples  time  \\
            1.0  2.6e-8  \\
            2.0  2.93e-7  \\
            5.0  5.74e-7  \\
            10.0  2.018e-6  \\
            22.0  5.585e-6  \\
            46.0  1.1665e-5  \\
            100.0  2.5141e-5  \\
            215.0  5.3828e-5  \\
            464.0  0.000117093  \\
            1000.0  0.000278003  \\
        }
        ;
\end{groupplot}
\node[anchor=north, align=center] at ($(group c1r2.west |- group c1r2.outer south)!0.5!(group c2r2.east |- group c2r2.outer south)$){number of samples \\[0.05\linewidth] \pgfplotslegendfromname{timings_legend}};
\node[anchor=south, rotate=90] at ($(group c1r1.north -| group c1r1.outer west)!0.5!(group c1r2.south -| group c1r2.outer west)$){time [sec]};
\end{tikzpicture}
